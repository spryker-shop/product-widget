{% extends template('widget') %}

{% define data = {
    product: _widget.product,
    viewMode: _widget.viewMode,
} %}

{% block body %}
    {% set productTemplate = molecule('product-card') %}
    {% set class = 'col col--sm-12 col--md-6 col--lg-6 col--xl-4' %}

    {% if data.viewMode == 'list' %}
        {% set productTemplate = molecule('product-list-item') %}
        {% set class = 'col col--sm-12' %}
    {% endif %}

    {% embed productTemplate with {
        _widget: _widget,
        productTemplate: productTemplate,
        class: class,
        data: {
            name: data.product.abstract_name,
            abstractId: data.product.id_product_abstract,
            url: data.product.url,
            imageUrl: data.product.images is empty ? '' : data.product.images.0.external_url_small,
            price: data.product.prices.DEFAULT | default(null),
            originalPrice: data.product.prices.ORIGINAL is defined ? data.product.prices.ORIGINAL : null
        }
    } only %}
        {% block labels %}
            {% widget 'ProductConcreteLabelWidget' args [_widget.product.id_product_labels] only %}
            {% elsewidget 'ProductLabelWidgetPlugin' args [_widget.product.id_product_labels] only %} {# @deprecated Use ProductConcreteLabelWidget instead. #}
            {% endwidget %}
        {% endblock %}

        {% block rating %}
            {% if _widget.product.rating is defined %}
                {% widget 'ProductReviewDisplayWidget' args [_widget.product.rating] only %}
                {% elsewidget 'ProductReviewWidgetPlugin' args [_widget.product.rating] only %} {# @deprecated Use ProductReviewDisplayWidget instead. #}
                {% endwidget %}
            {% endif %}
        {% endblock %}
    {% endembed %}
{% endblock %}
